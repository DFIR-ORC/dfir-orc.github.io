<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>DFIR ORC Command-line Options &#8212; DFIR ORC  documentation</title>
    <link rel="stylesheet" href="_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="WolfLauncher Configuration File" href="wolf_config.html" />
    <link rel="prev" title="Referencing resources in configurations" href="resources.html" /><link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'>
<link href="_static/solarized-dark.css" rel="stylesheet">
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        
        
        <li class="right" >
          <a href="wolf_config.html" title="WolfLauncher Configuration File"
             accesskey="N">next</a>
          
        
        
        <li class="right" >
          <a href="resources.html" title="Referencing resources in configurations"
             accesskey="P">previous</a>
           |</li>
          
        
        <li class="nav-item nav-item-0"><a href="index.html">DFIR ORC  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="configuration.html" accesskey="U">DFIR ORC Configuration</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.jpg" alt="Logo"/>
            </a></p>
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="platforms.html">Requirements &amp; Supported Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_to_data_collection.html">DFIR ORC Design and Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="configuration.html">DFIR ORC Configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tuto.html">Getting Started With DFIR ORC Configuration Files: A Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="resources.html">Referencing resources in configurations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">DFIR ORC Command-line Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="wolf_config.html">WolfLauncher Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="ToolEmbed.html">ToolEmbed</a></li>
<li class="toctree-l2"><a class="reference internal" href="orc_local_config.html">DFIR ORC Local Configuration File</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tool_list.html">DFIR ORC Embedded Tool Suite</a></li>
<li class="toctree-l1"><a class="reference internal" href="licenses.html">Licenses</a></li>
</ul>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="dfir-orc-command-line-options">
<h1>DFIR ORC Command-line Options<a class="headerlink" href="#dfir-orc-command-line-options" title="Permalink to this headline">¶</a></h1>
<p>DFIR ORC cannot be solely configured using command-line options. It never was and never will be possible.
DFIR ORC is configured using XML configuration files. Command-line options are too often misused, misspelled or misunderstood
by users and/or administrators. DFIR ORC aims to be error resilient and deliver its output no matter what.
That being said, command-line options can be used to change certain behaviors of a configured binary.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Options are case insensitive.</p>
</div>
<div class="section" id="out-option">
<h2>/Out Option<a class="headerlink" href="#out-option" title="Permalink to this headline">¶</a></h2>
<p>This option is used to modify the output location of the archives. This must be an existing directory with write access for the user running <code class="docutils literal notranslate"><span class="pre">DFIR-Orc.exe</span></code>.</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>/out=<span class="p">&lt;</span>OutputFolder&gt;
/out=\\myServer\MyShare\OutputFolder
</pre></div>
</div>
<p>By default, outputs are written in the current directory a.k.a. ‘.’</p>
<p>This option overrides the output location setting defined by the <a class="reference internal" href="orc_local_config.html#orc-local-config-output-element"><span class="std std-ref">output element</span></a> in a local configuration file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This option won’t affect the upload location.</p>
</div>
</div>
<div class="section" id="tempdir-option">
<h2>/TempDir Option<a class="headerlink" href="#tempdir-option" title="Permalink to this headline">¶</a></h2>
<p>Used to change the temporary folder used for temporary files.</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>/tempdir=<span class="p">&lt;</span>OutputFolder&gt;
/tempdir=<span class="nv">%temp%</span>\MyTemp
</pre></div>
</div>
<p>By default, %TEMP%\WorkingTemp\ is used.</p>
<p>This options overrides the directory defined in the <a class="reference internal" href="orc_local_config.html#orc-local-config-temporary-element"><span class="std std-ref">temporary element</span></a> in a local configuration file.</p>
</div>
<div class="section" id="keys-option">
<h2>/Keys Option<a class="headerlink" href="#keys-option" title="Permalink to this headline">¶</a></h2>
<p>The option /Keys can be used to visualize the archives and commands of a configured binary <code class="docutils literal notranslate"><span class="pre">DFIR-Orc.exe</span></code>.
When /Keys is used, no command is executed, no archives are created.</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>/Keys
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>/Keys can used in conjunction with /Key, /+Key and /-Key to visualize the command and archives actually selected to be collected.</p>
</div>
</div>
<div class="section" id="key-keyword-key-keyword-and-key-keyword-options">
<h2>/Key=&lt;Keyword&gt;, /+Key=&lt;Keyword&gt; and /-Key=&lt;Keyword&gt; Options<a class="headerlink" href="#key-keyword-key-keyword-and-key-keyword-options" title="Permalink to this headline">¶</a></h2>
<p>The /Key options allow to select only specific commands to be executed or archives to be generated. All non-matching keywords or archives are not executed or generated (and no warning message displayed).</p>
<p>The /+Key option will enable an optional archive or command (cf. <a class="reference internal" href="wolf_config.html#wolf-config-archive-element"><span class="std std-ref">archive element</span></a>, <a class="reference internal" href="wolf_config.html#wolf-config-command-element"><span class="std std-ref">command element</span></a>).</p>
<p>The /-Key option will disable an archive generation or command execution.</p>
<p>/+Key and /-Key can be combined and  repeated on the command line. /+Key options take effect first and then the /-Key ones. The &lt;Keyword&gt; parameter can be a comma separated list of keywords.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keywords are case insensitive.</p>
</div>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>/Key=<span class="p">&lt;</span>Keyword&gt;
/Key=Main

/+Key=<span class="p">&lt;</span>Keyword&gt;
/+Key=GetYara

/-Key=<span class="p">&lt;</span>Keyword&gt;
/-Key=Hives,NTFSInfo
</pre></div>
</div>
<p>By default, all non-optional archives and commands are generated.</p>
<p>This option overrides the attributes of the <a class="reference internal" href="wolf_config.html#wolf-config-archive-element"><span class="std std-ref">archive element</span></a> and the <a class="reference internal" href="wolf_config.html#wolf-config-command-element"><span class="std std-ref">command element</span></a>.</p>
<p>It also overrides optional settings using <a class="reference internal" href="orc_local_config.html#orc-local-config-key-element"><span class="std std-ref">key, enable_key and disable_key elements</span></a> in a local configuration file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>“c++” syntax /Key+=&lt;keyword&gt; and /Key-=&lt;keyword&gt; is also supported.</p>
</div>
</div>
<div class="section" id="nochilddebug-and-childdebug-options">
<h2>/NoChildDebug and /ChildDebug Options<a class="headerlink" href="#nochilddebug-and-childdebug-options" title="Permalink to this headline">¶</a></h2>
<p>This option disables the debugger of DFIR ORC.</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>/NoChildDebug
/ChildDebug
</pre></div>
</div>
<p>The debugger is disabled by default.</p>
<p>This option overrides the “ChildDebug” attribute set in the <a class="reference internal" href="wolf_config.html#wolf-config-wolf-element"><span class="std std-ref">wolf element</span></a>.</p>
</div>
<div class="section" id="once-overwrite-and-createnew-options">
<h2>/Once, /Overwrite and /CreateNew Options<a class="headerlink" href="#once-overwrite-and-createnew-options" title="Permalink to this headline">¶</a></h2>
<p>These options control the behavior of the launcher when the output archives are already present in the output or upload location (cf. <a class="reference internal" href="wolf_config.html#wolf-config-archive-element"><span class="std std-ref">archive element</span></a>).</p>
<p>These options apply to all archives created by the execution of <code class="docutils literal notranslate"><span class="pre">DFIR-Orc.exe</span></code>.</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>/Once
/OverWrite
/CreateNew
</pre></div>
</div>
<p>This option overrides the attribute <em>repeat</em> set in the <a class="reference internal" href="wolf_config.html#wolf-config-archive-element"><span class="std std-ref">archive element</span></a> in a WolfLauncher configuration file.</p>
</div>
<div class="section" id="compression-option">
<h2>/Compression Option<a class="headerlink" href="#compression-option" title="Permalink to this headline">¶</a></h2>
<p>This option controls the level of compression for generated archives.
Allowed values are: None, Fastest, Fast, Normal, Maximum, Ultra.</p>
<p>The override applies to all archives created by the DFIR ORC execution.</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>/Compression=<span class="p">&lt;</span>Value&gt;
/compression=Fast
</pre></div>
</div>
<p>By default, level “Normal” is used.</p>
<p>This option overrides the attribute <em>compression</em> set in the <a class="reference internal" href="wolf_config.html#wolf-config-archive-element"><span class="std std-ref">archive element</span></a> in a WolfLauncher configuration file.</p>
</div>
<div class="section" id="archive-timeout-option">
<h2>/archive_timeout Option<a class="headerlink" href="#archive-timeout-option" title="Permalink to this headline">¶</a></h2>
<p>This option configures the number of minutes during which the archive is allowed to run _after_ the last command finishes. In other words, this parameter is the timeout after which the archive is cancelled at the end of command execution.</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>/archive_timeout=<span class="p">&lt;</span>Value&gt;
/archive_timeout=10 In config file
</pre></div>
</div>
<p>By default, an archive creation has to complete within 5 minutes after the last command terminates.</p>
<p>This option overrides the <em>archive_timeout</em> attribute set in the <a class="reference internal" href="wolf_config.html#wolf-config-archive-element"><span class="std std-ref">archive element</span></a> in a WolfLauncher configuration file.</p>
</div>
<div class="section" id="command-timeout-option">
<h2>/command_timeout Option<a class="headerlink" href="#command-timeout-option" title="Permalink to this headline">¶</a></h2>
<p>This option configures the time span (in minutes) during which the command engine is allowed to run. In other words, this parameter configures the total amount of time, per archive, the commands can take to execute.</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span>/command_timeout=<span class="p">&lt;</span>Value&gt;
/command_timeout=180
</pre></div>
</div>
<p>By default, after 3 hours, any pending command is killed, the archive is properly completed and closed.</p>
<p>This option overrides the attribute <em>command_timeout</em> of the <a class="reference internal" href="wolf_config.html#wolf-config-archive-element"><span class="std std-ref">archive element</span></a> in a WolfLauncher configuration file.</p>
</div>
<div class="section" id="tee-cleartext-option">
<h2>/tee_cleartext Option<a class="headerlink" href="#tee-cleartext-option" title="Permalink to this headline">¶</a></h2>
<p>This option is for <em>testing/debugging purposes only</em>. It will create a clear text file alongside the encrypted file when DFIR ORC is encrypting its output (cf <a class="reference internal" href="wolf_config.html#wolf-config-recipient-element"><span class="std std-ref">wolf recipient element</span></a>).</p>
</div>
<div class="section" id="no-journaling-option">
<h2>/no_journaling Option<a class="headerlink" href="#no-journaling-option" title="Permalink to this headline">¶</a></h2>
<p>This option disables the journal format inside PKCS#7 CMS messages (for encrypted archives), thus directly creating the enveloped archive inside the CMS message (at the expense of a temporary clear text file created on disk).</p>
</div>
<div class="section" id="werdontshowui-option">
<h2>/WERDontShowUI Option<a class="headerlink" href="#werdontshowui-option" title="Permalink to this headline">¶</a></h2>
<p>When <code class="docutils literal notranslate"><span class="pre">DFIR-Orc.exe</span></code> and children crash (no matter whether child debug is enabled), it may happen that a user interface is shown to the user, asking for interaction.</p>
<p>This results in a loss of concurrent execution and <code class="docutils literal notranslate"><span class="pre">DFIR-Orc.exe</span></code> eventually hangs (when all concurrent runs are blocked by this UI). To prevent this, the WERDontShowUI option temporarily disables WER UI (Microsoft Windows Error Reporting). When DFIR ORC ends, we reset this parameter to its previous value.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using this option may modify twice the registry value of <code class="docutils literal notranslate"><span class="pre">HKEY_CURRENT_USER\Software\Microsoft\Windows\Windows</span> <span class="pre">Error</span> <span class="pre">Reporting,DontShowUI</span></code>.</p>
</div>
<p>By default, it is disabled (WER prompts are shown).</p>
<p>This option overrides the attribute <em>werdontshowui</em> of the <a class="reference internal" href="wolf_config.html#wolf-config-wolf-element"><span class="std std-ref">wolf element</span></a>.</p>
</div>
<div class="section" id="priority-option">
<h2>/Priority Option<a class="headerlink" href="#priority-option" title="Permalink to this headline">¶</a></h2>
<p>To avoid impact on the user experience during the tool execution, <code class="docutils literal notranslate"><span class="pre">DFIR-Orc.exe</span></code> can be launched with a modified priority (typically below normal).</p>
<p>Available priority values are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>/priority=low</p></td>
<td><p>BELOW_NORMAL_PRIORITY_CLASS</p></td>
</tr>
<tr class="row-even"><td><p>/priority=normal</p></td>
<td><p>NORMAL_PRIORITY_CLASS</p></td>
</tr>
<tr class="row-odd"><td><p>/priority=high</p></td>
<td><p>ABOVE_NORMAL_PRIORITY_CLASS</p></td>
</tr>
</tbody>
</table>
<p>This option overrides the attribute <em>priority</em> of the <a class="reference internal" href="orc_local_config.html#orc-local-config-dfir-orc-element"><span class="std std-ref">dfir-orc element</span></a> in a local configuration file.</p>
</div>
<div class="section" id="powerstate-option">
<h2>/PowerState Option<a class="headerlink" href="#powerstate-option" title="Permalink to this headline">¶</a></h2>
<p>To avoid letting the computer sleep (a.k.a. going to StandBy or S3 power mode) when the user is away, this option can be used with the following values:</p>
<ul class="simple">
<li><p>SystemRequired</p></li>
<li><p>DisplayRequired</p></li>
<li><p>UserPresent</p></li>
<li><p>AwayMode</p></li>
</ul>
<p>To only prevent sleep, recommended value for this option is: SystemRequired,AwayMode.</p>
<p>This option overrides the <em>powerstate</em> attribute of the <a class="reference internal" href="orc_local_config.html#orc-local-config-dfir-orc-element"><span class="std std-ref">dfir-orc element</span></a> in a local configuration file.</p>
</div>
<div class="section" id="mothership-specific-command-line-options">
<h2>Mothership Specific Command-line Options<a class="headerlink" href="#mothership-specific-command-line-options" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="architecture.html#architecture-exec"><span class="std std-ref">Mothership mechanism</span></a> allows DFIR ORC to be executed in any compatible context (Scheduled Task, Logon Script, Startup script, x86/x64…). The configuration allows the Mothership to launch the subsequent execution which suits the context. Specific command-line options can be used to customize this behavior.</p>
<div class="section" id="nowait-option">
<h3>-NoWait Option<a class="headerlink" href="#nowait-option" title="Permalink to this headline">¶</a></h3>
<p>With this option, the mothership will execute the command engine (i.e. WolfLauncher) with appropriate options (CREATE_SUSPENDED|CREATE_BREAKAWAY_FROM_JOB) and return immediately. This option is typically used in startup scripts which could limit the time <code class="docutils literal notranslate"><span class="pre">DFIR-Orc.exe</span></code> is allowed to run.</p>
</div>
<div class="section" id="wmi-option">
<h3>-WMI Option<a class="headerlink" href="#wmi-option" title="Permalink to this headline">¶</a></h3>
<p>With this option, the mothership will execute the command engine (i.e. WolfLauncher) using WMI (the Win32_Process::Create method).</p>
</div>
<div class="section" id="preservejob-option">
<h3>-PreserveJob Option<a class="headerlink" href="#preservejob-option" title="Permalink to this headline">¶</a></h3>
<p>With this option, the mothership will _not_ alter the job under which it executes. By default, the mothership will attempt to modify the current job (if needed, typically to allow JOB_OBJECT_LIMIT_BREAKAWAY_OK).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using this option may lead to a failure in WolfLauncher command engine if BreakAwayFromJob is not allowed. See <a class="reference internal" href="platforms.html"><span class="doc">Requirements &amp; Supported Platforms</span></a> for more details.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        
        
        <li class="right" >
          <a href="wolf_config.html" title="WolfLauncher Configuration File"
             >next</a>
          
        
        
        <li class="right" >
          <a href="resources.html" title="Referencing resources in configurations"
             >previous</a>
           |</li>
          
        
        <li class="nav-item nav-item-0"><a href="index.html">DFIR ORC  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="configuration.html" >DFIR ORC Configuration</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2019, ANSSI. The contents of this documentation is available under the Open License version 2.0 as published by Etalab (French task force for Open Data). The name DFIR ORC and the associated logo belong to ANSSI, no use is permitted without its express approval. Le contenu de cette documentation est disponible sous license Open License version 2.0 telle que publiée par Etalab (organisation francaise pour Open Data). Le nom DFIR ORC et le logo associé appartiennent à l&#39;ANSSI, tout usage doit être expressément autorisé par l&#39;ANSSI..
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.2.0.Theme is <a href="http://github.com/vimalkvn/solar-theme">Solar</a>
    </div>
  </body>
</html>